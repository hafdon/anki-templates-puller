{
    "Card 1": {
        "Front": "<!DOCTYPE html>\n<html>\n\n<head>\n    <title>Irish Word Pronunciations</title>\n    <style>\n        body {\n            font-family: Arial, sans-serif;\n            margin: 30px;\n            text-align: center;\n        }\n\n        h1 {\n            margin-bottom: 20px;\n        }\n\n        h2 {\n            margin-bottom: 20px;\n        }\n\n\n        .dialect-selection {\n            margin-bottom: 30px;\n        }\n\n        select {\n            font-size: 16px;\n            padding: 5px 10px;\n        }\n\n        button {\n            font-size: 18px;\n            padding: 10px 20px;\n            margin: 10px;\n            cursor: pointer;\n            transition: background-color 0.3s, opacity 0.3s;\n        }\n\n        button:disabled {\n            opacity: 0.5;\n            cursor: not-allowed;\n        }\n\n        /* Style for buttons when audio is playing */\n        .playing {\n            background-color: #4caf50;\n            /* Green color indicating playing */\n            color: white;\n        }\n\n        #instructions {\n            margin-top: 30px;\n            font-size: 16px;\n            color: #555;\n        }\n\n        .forvo-link {\n            margin-top: 20px;\n        }\n\n        .forvo-pronunciations {\n            margin-top: 20px;\n        }\n\n        /* New styles for additional audio buttons */\n        .additional-audios {\n            margin-top: 30px;\n        }\n\n        .additional-audios h3 {\n            margin-bottom: 15px;\n        }\n\n        .audio-button {\n            margin: 5px;\n        }\n    </style>\n</head>\n\n<body>\n    <h1>{{Word}}</h1>\n\n    <div class=\"dialect-selection\">\n        <label for=\"dialectSelect\"><strong>Select Pronunciation Dialect:</strong></label>\n        <select id=\"dialectSelect\">\n            <option value=\"\">-- Random --</option>\n            <option value=\"Connacht\">Connacht</option>\n            <option value=\"Ulster\">Ulster</option>\n            <option value=\"Munster\">Munster</option>\n        </select>\n        <button id=\"resetDialect\">Reset Selection</button>\n    </div>\n\n    <h3>Pronunciation:</h3>\n\n    <button id=\"btnPronunciation\">Play Pronunciation (Press 'Z')</button>\n\n    <!-- Audio element for primary pronunciation -->\n    <audio id=\"audioPronunciation\" preload=\"auto\"></audio>\n\n    <div class=\"forvo-pronunciations\">\n        {{ForvoPronunciations}}\n    </div>\n\n    <div class=\"forvo-link\">\n        <a href=\"https://forvo.com/search/{{Word}}\" target=\"_blank\">Listen to more pronunciations on Forvo</a>\n    </div>\n\n    <!-- New Section for Additional Audio URLs -->\n    {{#AudioUrls}}\n    <div class=\"additional-audios\">\n        <h3>Additional Pronunciations:</h3>\n        <div id=\"additionalAudioContainer\"></div>\n    </div>\n    {{/AudioUrls}}\n\n    <script>\n\n        // Retrieve the word from Anki\n        var word = \"{{Word}}\";\n\n        // Elements\n        var dialectSelect = document.getElementById(\"dialectSelect\");\n        var resetDialectBtn = document.getElementById(\"resetDialect\");\n        var btnPronunciation = document.getElementById(\"btnPronunciation\");\n        var audioPronunciation = document.getElementById(\"audioPronunciation\");\n\n        // Define available dialects with their corresponding codes and keyboard keys\n        var dialects = {\n            Connacht: { code: \"CanC\", label: \"Connacht\" },\n            Ulster: { code: \"CanU\", label: \"Ulster\" },\n            Munster: { code: \"CanM\", label: \"Munster\" },\n        };\n\n        function setSelectedDialect(dialect) {\n            if (dialect) {\n                localStorage.setItem(\"selectedDialect\", dialect);\n                console.log(\"Dialect set to:\", dialect);\n            } else {\n                localStorage.removeItem(\"selectedDialect\");\n                console.log(\"Dialect selection cleared\");\n            }\n        }\n\n        function getSelectedDialect() {\n            var dialect = localStorage.getItem(\"selectedDialect\");\n            console.log(\"Retrieved dialect:\", dialect);\n            return dialect;\n        }\n\n        // Function to create a pronunciation button\n        // Since dialect selection is global, only one button is needed\n        function setupPronunciationButton() {\n            btnPronunciation.addEventListener(\"click\", function () {\n                console.log(\"Play button clicked\");\n                playPronunciation();\n            });\n        }\n\n        // Function to set up audio event listeners\n        function setupAudioEvents() {\n            audioPronunciation.addEventListener(\"play\", function () {\n                btnPronunciation.classList.add(\"playing\");\n            });\n\n            audioPronunciation.addEventListener(\"ended\", function () {\n                btnPronunciation.classList.remove(\"playing\");\n            });\n\n            audioPronunciation.addEventListener(\"pause\", function () {\n                btnPronunciation.classList.remove(\"playing\");\n            });\n\n            audioPronunciation.addEventListener(\"error\", function () {\n                btnPronunciation.disabled = true;\n                btnPronunciation.title = \"Audio not available\";\n            });\n        }\n\n        function playPronunciation() {\n            var selectedDialect = getSelectedDialect();\n            var dialectCode;\n\n            if (selectedDialect && dialects[selectedDialect]) {\n                dialectCode = dialects[selectedDialect].code;\n            } else {\n                var dialectNames = Object.keys(dialects);\n                var randomDialectName = dialectNames[Math.floor(Math.random() * dialectNames.length)];\n                dialectCode = dialects[randomDialectName].code;\n            }\n\n            var encodedWord = encodeURIComponent(word);\n            audioPronunciation.src = \"https://www.teanglann.ie/\" + dialectCode + \"/\" + encodedWord + \".mp3\";\n\n            // Play the main pronunciation audio\n            audioPronunciation.play().catch((error) => {\n                console.error(\"Autoplay failed for word {{Word}}: \", error);\n                console.log(error.name, \" \", error.message, \" \", error.code)\n            });\n        }\n\n        // Function to initialize dialect selection\n        function initializeDialectSelection() {\n            // Set the dropdown to the stored dialect if any\n            var storedDialect = getSelectedDialect();\n            if (storedDialect && dialects[storedDialect]) {\n                dialectSelect.value = storedDialect;\n            } else {\n                dialectSelect.value = \"\";\n            }\n\n            // Event listener for dialect selection change\n            dialectSelect.addEventListener(\"change\", function () {\n                var selected = dialectSelect.value;\n                if (selected && dialects[selected]) {\n                    setSelectedDialect(selected);\n                    alert(\"Dialect set to \" + selected + \". This will apply to all cards in this review session.\");\n                } else {\n                    setSelectedDialect(null);\n                    alert(\"Dialect selection cleared. Dialects will be chosen randomly.\");\n                }\n            });\n\n            // Event listener for reset button\n            resetDialectBtn.addEventListener(\"click\", function () {\n                dialectSelect.value = \"\";\n                setSelectedDialect(null);\n                alert(\"Dialect selection has been reset. Dialects will be chosen randomly.\");\n            });\n        }\n\n        // Add keyboard shortcut (Press 'Z') to play pronunciation\n        document.addEventListener(\"keydown\", function (event) {\n            if (event.key.toLowerCase() === \"z\") {\n                playPronunciation();\n            }\n        });\n\n        function disableAutoplayOnOtherAudios() {\n            var audios = document.querySelectorAll('audio');\n            audios.forEach(function (audio) {\n                if (audio.id !== 'audioPronunciation') {\n                    // Remove autoplay attribute if present\n                    audio.autoplay = false;\n                    audio.removeAttribute('autoplay');\n\n                    // Pause the audio in case it starts playing\n                    audio.pause();\n\n                    // Ensure the audio does not autoplay via other means\n                    audio.onplay = function () {\n                        audio.pause();\n                    };\n\n                    // Add a play button or make the audio element clickable to play\n                    // Here, we'll make the audio element itself clickable\n                    audio.style.cursor = 'pointer';\n                    audio.addEventListener('click', function () {\n                        // Toggle play/pause on click\n                        if (audio.paused) {\n                            audio.play();\n                        } else {\n                            audio.pause();\n                        }\n                    });\n                }\n            });\n        }\n\n        // Function to handle additional audio URLs\n        function setupAdditionalAudios() {\n            var additionalAudioContainer = document.getElementById(\"additionalAudioContainer\");\n            if (!additionalAudioContainer) return;\n\n            var audioUrlsRaw = \"{{AudioUrls}}\".trim();\n            if (audioUrlsRaw === \"\") return;\n\n            // Split the URLs by spaces\n            var audioUrls = audioUrlsRaw.split(/\\s+/);\n\n            audioUrls.forEach(function (url, index) {\n                // Create a container for each audio button and label\n                var audioWrapper = document.createElement(\"div\");\n                audioWrapper.style.marginBottom = \"10px\";\n\n                // Create the play button\n                var playButton = document.createElement(\"button\");\n                playButton.textContent = \"Play Audio \" + (index + 1);\n                playButton.classList.add(\"audio-button\");\n\n                // Create the audio element\n                var audioElement = document.createElement(\"audio\");\n                audioElement.src = url;\n                audioElement.preload = \"auto\";\n\n                // Event listeners for play/pause state\n                playButton.addEventListener(\"click\", function () {\n                    if (audioElement.paused) {\n                        audioElement.play();\n                    } else {\n                        audioElement.pause();\n                    }\n                });\n\n                audioElement.addEventListener(\"play\", function () {\n                    playButton.classList.add(\"playing\");\n                    // Pause other audios\n                    pauseOtherAudios(audioElement);\n                });\n\n                audioElement.addEventListener(\"pause\", function () {\n                    playButton.classList.remove(\"playing\");\n                });\n\n                audioElement.addEventListener(\"ended\", function () {\n                    playButton.classList.remove(\"playing\");\n                });\n\n                audioElement.addEventListener(\"error\", function () {\n                    playButton.disabled = true;\n                    playButton.title = \"Audio not available\";\n                });\n\n                // Append button and audio to the wrapper\n                audioWrapper.appendChild(playButton);\n                audioWrapper.appendChild(audioElement);\n\n                // Append the wrapper to the container\n                additionalAudioContainer.appendChild(audioWrapper);\n            });\n        }\n\n        // Function to pause other additional audios when one starts playing\n        function pauseOtherAudios(currentAudio) {\n            var allAdditionalAudios = document.querySelectorAll('.additional-audios audio');\n            allAdditionalAudios.forEach(function (audio) {\n                if (audio !== currentAudio && !audio.paused) {\n                    audio.pause();\n                }\n            });\n        }\n\n        function initializeCard() {\n            setupPronunciationButton();\n            setupAudioEvents();\n            initializeDialectSelection();\n            disableAutoplayOnOtherAudios();\n            setupAdditionalAudios();\n        }\n\n        // Call the initialize function on load\n        initializeCard();\n\n        // Optionally, auto-play the pronunciation on load\n        playPronunciation();\n\n        // Handle cases where Anki dynamically updates the card content\n        // MutationObserver can watch for changes in the DOM and re-apply settings\n        var observer = new MutationObserver(function (mutations) {\n            mutations.forEach(function (mutation) {\n                if (mutation.type === 'childList') {\n                    disableAutoplayOnOtherAudios();\n                    setupAdditionalAudios(); // Re-setup additional audios if DOM changes\n                }\n            });\n        });\n\n        // Start observing the body for changes\n        observer.observe(document.body, { childList: true, subtree: true });\n    </script>\n</body>\n\n</html>\n",
        "Back": "{{FrontSide}}\n\n<hr id=answer>\n\n{{Back}}\n\n<i>{{frequency}}</i>\n"
    }
}